<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>

<%= javascript_include_tag "jquery.tokeninput.js" %>
<%= stylesheet_link_tag "token-input.css" %>

<script type="text/javascript">
$(document).ready(function () {
    $("#skills_input").tokenInput("/skills.json", {
      crossDomain: false,
    });
});
</script>

<% content_for :map do %>
  <script>
    var map_hash = <%= raw @hash.to_json %>;
  </script>
  <%= render 'layouts/map' %>
<% end %>

<br>
<br>

<div>
    <%= text_field_tag "skills_input", "" %>
</div>




<div class="page-header-block">
  <h1>All Needs</h1>
</div>

<div class="needs main-content">
  <% @needs.each do |need| %>
    <div class="need-container">
      <div class="inner-content">
        <h2 class="need-title">
          <% if user_signed_in? %>
            <% if current_user == need.user_posted_by || current_user == need.user_church_admin %>
              <%= link_to need.title, need %>
            <% else %>
              <%= link_to need.title_public, need %>
            <% end %>
          <% else %>
              <%= link_to need.title_public, need %>
          <% end %>
        </h2>
        <div class="need-description">
          <% if user_signed_in? %>
            <% if current_user == need.user_posted_by || current_user == need.user_church_admin %>
              <p><%= need.description %></p>
            <% else %>
              <p><%= need.description_public %></p>
            <% end %>
          <% else %>
            <p><%= need.description_public %></p>
          <% end %>
          <div class="row need-details">
            <div class="expenses col-xs-12 col-sm-6">
              <h3>Expenses</h3>
                <div class="expenses-bar">
                  <span class="progress-bar" style="width:<%= need.percent_raised %>%"></span>
                  <span class="amount-raised"><%= humanized_money_with_symbol need.total_contributed %> / <%= humanized_money_with_symbol need.total_expenses %></span>
                </div>
            </div>
            <div class="skills col-xs-12 col-sm-6">
              <h3>Skills needed</h3>
              <div class="skills-bar">
                <span class="progress-bar"></span>
                <span class="skills-count"><%= need.skills_count %> 
                <% if need.skills_count == 1 %>
                  Skill
                <% else %>
                  Skills
                <% end %>
                </span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  <% end %>
</div>
